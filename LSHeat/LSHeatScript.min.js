function saveHeatmapSettings(){var t;for(t in heatmapSettingOptions){var e=$("#"+t);heatmapSettings[t]="boolean"==heatmapSettingOptions[t].type?e.is(":checked")?!0:!1:parseInt(e.val())}window.localStorage.removeItem("lst_heatmap_settings"),window.localStorage.setItem("lst_heatmap_settings",JSON.stringify(heatmapSettings)),parent.location.reload()}function handleMainWindow(){if(heatmapSettings["heatmap-activated"]){var t=document.createElement("script");t.type="text/javascript",t.src="https://jalibu.github.io/LSHeat/LSHeat/leaflet-heat.js",document.body.appendChild(t),$("#building_list .building_list_li").each(function(){var t=$(this),e=$(t).find(".map_position_mover").attr("data-longitude"),a=$(t).find(".map_position_mover").attr("data-latitude");$(this).find(".building_list_vehicle_element").each(function(){var t=$(this).find(".vehicle_building_list_button").attr("vehicle_type_id"),i=$(this).find(".vehicle_building_list_button").text(),n={vehicle_type_id:t,lat:a,"long":e,name:i};vehicles.push(n)})}),$(window).load(function(){var t=[];$(vehicles).each(function(){var e=this;e.vehicle_type_id==heatmapSettings["heatmap-vehicle"]&&t.push([e.lat,e.long,heatmapSettings["heatmap-intensity"]])});L.heatLayer(t,{radius:heatmapSettings["heatmap-radius"]}).addTo(map)})}$(window).load(function(){var t;t=heatmapSettings["heatmap-activated"]?carIds[heatmapSettings["heatmap-vehicle"]]:"Aktivieren",$(".leaflet-control-container .leaflet-bottom.leaflet-left").append('<a href="/leitstelle#tab_settings" id="heatmap-config" class="leaflet-bar leaflet-control leaflet-control-custom hidden-xs lightbox-open" style="background-color: white;  height: 30px;"><img style="height: 22px; width: 22px" src="https://jalibu.github.io/LSHeat/LSHeat/map.png"><span style="margin-left: 5px; margin-right: 5px;">'+t+"</span></a>")})}function handleIframeWindow(){var t=$("#iframe-inside-container .nav-tabs");$(t).text().indexOf("Einstellungen")>0&&($(t).append('<li role="presentation"><a data-toggle="tab" role="tab" aria-controls="tab_heatmap" href="#tab_heatmap" aria-expanded="false">Heatmap</a></li>'),renderSettings(),"#tab_settings"===window.location.hash&&$("a[href='#tab_heatmap']").click())}function renderSettings(){$(".tab-content").append('<div id="tab_heatmap" class="tab-pane active" role="tabpanel"></div>'),$("#tab_heatmap").append('<div class="form-horizontal" id="tab_heatmap_col"></div>');var t='<div class="form-group"><div class="col-sm-3"></div><div class="col-sm-9">',e="</div></div>";$("#tab_heatmap_col").append(t+'<label for="heatmap-activated" class="checkbox"><input type="checkbox" id="heatmap-activated">Aktiviert</label>'+e),heatmapSettings["heatmap-activated"]&&$("#heatmap-activated").attr("checked","checked"),$("#tab_heatmap_col").append(t+'<label for="heatmap-radius" class="input"><input type="text" value="'+heatmapSettings["heatmap-radius"]+'" id="heatmap-radius">Radius</label>'+e),$("#tab_heatmap_col").append(t+'<label for="heatmap-intensity" class="input"><input type="text" value="'+heatmapSettings["heatmap-intensity"]+'" id="heatmap-intensity">Intensität</label>'+e),$("#tab_heatmap_col").append(t+'<label for="heatmap-intensity" class="input"><select id="heatmap-vehicle"></select>Fahrzeug</label>'+e);for(var a in carIds)$("#heatmap-vehicle").append(heatmapSettings["heatmap-vehicle"]==a?'<option selected value="'+a+'">'+carIds[a]+"</option>":'<option value="'+a+'">'+carIds[a]+"</option>");$("#tab_heatmap_col").append(t+'<button id="heatmap_save" class="btn btn-success">Speichern</button>'+e),$("#heatmap_save").click(function(){saveHeatmapSettings()})}var carIds={0:"LF 20",1:"LF 10",2:"DLK 23",3:"ELW 1",4:"RW",5:"GW-A",6:"LF 8/6",7:"LF 20/16",8:"LF 10/6",9:"LF 16-TS",10:"GW-Öl",11:"GW-L2-Wasser",12:"GW-Messtechnik",13:"SW 1000",14:"SW 2000",15:"SW 2000-Tr",16:"SW KatS",17:"TLF 2000",18:"TLF 3000",19:"TLF 8/8",20:"TLF 8/18",21:"TLF 16/24-Tr",22:"TLF 16/25",23:"TLF 16/45",24:"TLF 20/40",25:"TLF 20/40-SL",26:"TLF 16",27:"GW-Gefahrgut",28:"RTW",29:"NEF",30:"HLF 20",31:"RTH",32:"FuStW",33:"GW-Höhenrettung",34:"ELW 2",35:"leBefKw",36:"MTW",37:"TSF-W",38:"KTW",39:"GKW",40:"MTW-TZ",41:"MzKW",42:"LKW K9",43:"BRmG R",44:"Anh. DLE",45:"MLW 5",46:"WLF",47:"AB-Rüst",48:"AB-Atemschutz",49:"AB-Öl",50:"GruKw",51:"FüKw",52:"GefKw",53:"GW Dekon-P",54:"AB-Dekon-P",55:"KdoW-LNA",56:"KdoW-OrgL",57:"Kran",58:"KTW Typ B",59:"ELW 1 (SEG)",60:"GW-SAN",61:"Polizeihubschrauber",62:"AB-Schlauch",63:"GW-Taucher",64:"GW-Wasserrettung",65:"LKW 7 Lkr 19 tm",66:"Anh MzB",67:"Anh SchlB",68:"Anh MzAB",69:"Tauchkraftwagen",70:"MZB",71:"AB-MZB"},heatmapSettingOptions={"heatmap-activated":{name:"Aktiviert",type:"boolean","default":!1},"heatmap-radius":{name:"Radius",type:"range","default":"80"},"heatmap-intensity":{name:"Intensität",type:"range","default":"15"},"heatmap-vehicle":{name:"Fahrzeug-Typ",type:"select","default":"0"}},heatmapSettings={};if(window.localStorage.getItem("lst_heatmap_settings"))heatmapSettings=JSON.parse(window.localStorage.getItem("lst_heatmap_settings"));else for(var key in heatmapSettingOptions)heatmapSettings[key]=heatmapSettingOptions[key].default;var vehicles=[];window.top!=window.self?handleIframeWindow():handleMainWindow();